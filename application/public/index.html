<!--
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * SPDX-License-Identifier: Apache-2.0
 * Original source: googlemaps/jssamples/addmap by willum070, amuramoto - https://github.com/googlemaps/js-samples/blob/main/samples/add-map/index.ts
 * Licensed under the Apache-2.0 License
 * Modifications made by Jacob Vallery on 04/26/2025
 * Description of changes: Added personal html, limited scope, trimmed unnecessary code for this application.
 -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DinnerWizard</title>
    <link rel="stylesheet" href="./style.css"/>
</head>
<body>
<div class="container">
    <br><br>
    <h1 class="text-center">
    DinnerWizard
    </h1>
    <div class="logo">
        <img src="images/DWLogo.png" alt="DinnerWizard Logo" class="logo-image">
    </div>
    <div class="background" id="map"></div>
    <div class="form-group">
        <br><br>
        <input type="text" class="form-control" id="autocomplete" placeholder="Enter Location"/>
    </div>
    <br>
    <div class="form-group">
        <label for="places">Select Style:</label>
        <br><br>
        <select class="form-control" name="" id="type" aria-placeholder="Select Type">
            <option value="cafe">Caf√©</option> 
            <option value="restaurant">Restaurant</option>
            <option value="bar">Bar</option>
        </select>
        <br><br>
    </div>
    <div class="form-group">
        <label for="radius">Select Distance:</label>
        <br><br>
        <select class="form-control" name="" id="radius" aria-placeholder="Select Distance">
            <option value="1609">1 mile</option>
            <option value="3218">2 miles</option>
            <option value="8046">5 miles</option>
            <option value="16093">10 miles</option>
        </select> 
    </div>
    <br><br>    
    <table class="table table-bordered table-striped" id="places"></table>
</div>

</body>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBD5IALn7vlk64h-ImW1Lv3A4CCT3ytKU0&libraries=places&v=weekly&callback=initMap"
    type="text/javascript" async defer>
    </script>

<script>  //JavaScript functions below.
    //Creating the map after a location has been set with the Autocomplete SearchBar.
    function initMap() {
        autocomplete = new google.maps.places.Autocomplete(document.getElementById('autocomplete'), {
            types: ['geocode'],
        });

        autocomplete.addListener('place_changed', searchNearbyPlaces)
    }//end initMap

    document.getElementById('type').onchange = searchNearbyPlaces //now the list will update each time the drop down list is changed.
    document.getElementById('radius').onchange = searchNearbyPlaces //now the list will update each time the drop down list is changed.
            //
    function searchNearbyPlaces() {
        document.getElementById('places').innerHTML = '';

        var place = autocomplete.getPlace();
        console.log(place);

        map = new google.maps.Map(document.getElementById('map'), {
            center: place.geometry.location,
            zoom: 15,
        });
            
        // conducting the nearby search
        service = new google.maps.places.PlacesService(map);
        service.nearbySearch({
            location: place.geometry.location,
            radius: [document.getElementById('radius').value],
            types: [document.getElementById('type').value]

        }, callback);

    }//end searchNearbyPlaces
        //storing nearby search response results
    function callback(results, status) {
        if (status === google.maps.places.PlacesServiceStatus.OK) {
            console.log(results.length);
            for (var i = 0; i < results.length; i++) {
                 createMarker(results[i]);
            }
        }
    }//end callback
        //printing results to the application
    function createMarker(place) {
        console.log(place)
        var table = document.getElementById('places');
        var row = table.insertRow();
        var cell1 = row.insertCell(0);
        cell1.innerHTML = place.name;
        var cell2 = row.insertCell(1);
        cell2.innerHTML = place.vicinity;

    }//end createaMarker

</script> 
</html>
